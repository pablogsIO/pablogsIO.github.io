<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Pablo Garcia"/><link rel="canonical" href="https://pablogs.io/blog/2018-04-12-TubeLineStops"/><meta name="twitter:url" content="https://pablogs.io/blog/2018-04-12-TubeLineStops"/><meta name="og:url" content="https://pablogs.io/blog/2018-04-12-TubeLineStops"/><title>TubeLineStops | Pablo Garcia</title><meta name="twitter:title" content="TubeLineStops | Pablo Garcia"/><meta name="og:title" content="TubeLineStops | Pablo Garcia"/><meta name="description" content="Hello and welcome to the first post of this humble blog!"/><meta name="twitter:description" content="Hello and welcome to the first post of this humble blog!"/><meta name="og:description" content="Hello and welcome to the first post of this humble blog!"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Pablo Garcia"/></head><body class="item-page"><div class="wrapper"><header><div class="header-divider"><div class="site"><a class="site-name" href="/">Pablo Garcia</a><p>Apps for iPhone, iPad, Apple TV and Apple Watch</p></div><nav class="header-nav"><ul class="header-ul"><li class="header-li"><a href="/home">home</a></li><li class="header-li"><a class="selected" href="/blog">blog</a></li><li class="header-li"><a href="/contact">contact</a></li></ul></nav></div></header><article><div class="content-post-detail"><h1 class="post-title">TubeLineStops</h1><p class="release-date">Apr 12, 2018</p><p>Hello and welcome to the first post of this humble blog!</p><p>A few months ago I did the <a href="https://itunes.apple.com/bz/app/luas-dublin/id1257004479?l=en&mt=8">Luas Dublin app</a>. This app shows Luas lines and real-time information for each stop. What I would like to share with you today is a class that I used to draw Luas lines and stops. You can download a full example <a href="https://github.com/pablogsIO/TubeLineStops">here</a>.</p><p>The TubeLineStop class is an UIView subclass. This class draws parts of the line, these parts could be the beginning of the line, the end, forks etc. You can see different types here:</p><p align="center">
  <img width="200" src="/images/posts/tube/tailLeft.png">
  <img width="200" src="/images/posts/tube/tailForkedLefStoptDown.png">
  <img width="200" src="/images/posts/tube/unionRightStopUp.png">
  <img width="200" src="/images/posts/tube/middle.png">
  <img width="200" src="/images/posts/tube/forkLeftStopDown.png">
  <img width="200" src="/images/posts/tube/tailRight.png">
</p><p>You can configure the color of the line and the type of the stop that you are drawing.</p><p>The TubeLineStop class overwrite the draw function of the UIView class. To draw the line, the first thing that we have to do is to create a context with the function UIGraphicsBeginImageContext. According to Apple class reference, UIGraphicsBeginImageContext creates a bitmap-based graphics context and makes it the current context.</p><p>So, let's do it</p><pre><code><span class="keyword">let</span> context = <span class="type">UIGraphicsGetCurrentContext</span>()
</code></pre><p>Once we have the context, we can draw lines, circles or whatever we want. For example, to draw the first stop of a line we could do something like this:</p><pre><code>context?.<span class="call">setLineWidth</span>(<span class="number">4.0</span>) (<span class="number">1</span>)
context?.<span class="call">setStrokeColor</span>(color) (<span class="number">2</span>)
context?.<span class="call">move</span>(to: <span class="type">CGPoint</span>(x: width/<span class="number">2</span>, y: yLinePosition)) (<span class="number">3</span>)
context?.<span class="call">addLine</span>(to: <span class="type">CGPoint</span>(x: width, y: yLinePosition)) (<span class="number">4</span>)
context?.<span class="call">strokePath</span>()(<span class="number">5</span>)
context?.<span class="call">addEllipse</span>(in: <span class="type">CGRect</span>(x: width/<span class="number">2</span>, y: yStopPosition, 
		   width: circleDiameter, height: circleDiameter)) (<span class="number">6</span>)
context?.<span class="call">fillPath</span>() (<span class="number">7</span>)
context?.<span class="call">strokePath</span>()
</code></pre><p>First, we have to set the line width (1) and the stroke colour (2). The next step is to move to the starting point of the line that is going to be drawn (3). With (4) we specified where the end of the line is. After that, having defined the line width, colour and path, we are ready to draw the line (5). To draw the tube stop, we must define the rectangular area into which the shape must fit and then call the addEllipse(in:) context method (6). With (7) we fill the path.</p><p>And that’s it! You can download the full project <a href="https://github.com/pablogsIO/TubeLineStops">here</a></p></div></article><footer><p>© 2021 Pablo Garcia. Built in Swift using <a href="https://github.com/johnsundell/publish" target="_blank" rel="noreferrer">Publish</a></p><p><a href="https://github.com/pablogsio" target="_blank" rel="noreferrer">GitHub</a> | <a href="https://pablogs.io/feed.rss">RSS Feed</a></p></footer></div></body></html>